### TABLE RELATION
<left>![img1](/query/elt_flow.png)</left>

## external 테이블 데이터의 문제점
SQL을 사용하여 웨어하우스 내에서 재 처리를 해 주었다.
`create_external_to_raw.sql`, `create_visuals.sql`

### **`` `external.recruit_table` ``**
|position_title|position_industry|position_location|position_job_type|position_job_mid_code|position_industry_keyword_code|position_job_code_keyword_code|position_experience_level_code|position_experience_level_min|position_experience_level_max|position_required_education_level|keyword|salary|posting_timestamp|posting_date|expiration_timestamp|expiration_date|read_cnt|apply_cnt|
|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|
|IDC구축분야 안전관리(가산) 프로젝트계약직 채용|305|101080|2|22,2|999|154,2037,2048,154|2|3|0|0|null|99|1685494276|2023-05-31T09:51:16+0900|1703948400|2023-12-31T00:00:00+0900|0|0|
|2023년 5월 경력사원 채용|121|101080,101150,101230,101240,102000|1|2,18|999|90,127,167,2212,167|2|2|0|8|null|99|1685068573|2023-05-26T11:36:13+0900|1686099600|2023-06-07T10:00:00+0900|328|0|
|에너지머티리얼즈 정규직 채용|211|101000,101230,102400,111000,111020,111120,111150,111230|1|11,22,2,3,16,18,8,9|999|81,341,355,357,358,360,699,701,733,746,756,757,758,759,760,761,762,764,768,772,776,777,778,779,814,833,991,993,994,1001,1002,1004,1005,1006,1009,1010,1013,1015,1017,1018,1023,1028,1033,1046,1067,1138,1628,1754,1755,2052,2109,2160,2195,2196,2200,2203,2204,2208,2211,2212,2196,1046,1090,1113,1118,2204,...|3|0|0|6|null|99|1684889923|2023-05-24T09:58:43+0900|1686405600|2023-06-10T23:00:00+0900|5013|0|
|임베디드 시스템 플랫폼 연구개발 (경력: 팀장급)|301|101010|1|11,2|30113,30116,30118|100,128,139,166,174,182,204,205,206,235,246,1150,1203,128|2|7|0|8|소프트웨어개발,솔루션업체,시스템관리|99|1681295939|2023-04-12T19:38:59+0900|1685545199|2023-05-31T23:59:59+0900|194|10|
|[취업연계] 웹디자인/SW개발/네트워크 국비 교육생 모집|605|106000,106070,106120|12|11,22,2,14|60508|83,86,87,92,100,107,116,136,154,167,201,235,236,245,256,263,272,277,291,292,320,1005,1006,1022,1024,1032,1034,1089,1150,1153,1178,1203,1420,2020,2026,2040,2066,2071,2136,2140,2141,1005,1006,1022,1024,1032,1034,2196,1089,1150,1153,1178,1203,2020,2026,2040,2055,2066,2071,2136,2140,2178,83,86,87,92,104...|3|0|0|0|직업전문학교|0|1684389925|2023-05-18T15:05:25+0900|1685631599|2023-06-01T23:59:59+0900|472|0|

- position_location, position_job_code_keyword_code 등의 코드값 데이터 내 다중값이 존재
    - SPLIT(), UNNEST()를 사용하여 컴마 단위로 분리 후 레코드로 재결합

### **`` `external.certification` ``**
|____________|_____________1|_____________2|_____________3|_____________4|_________|
|-|-|-|-|-|-|
|정보처리기사|2022|기사|48470|27208|0.561|
|정보처리기사|2021|기사|51640|32865|0.636|
|sql|2012|개발자|844|267|31.64|
|sql|2022|개발자(공인)|32474|15845|48.79|
|sql|2022|전문가(공인)|629|64|10.17|

- csv파일에서 헤더값이 한글로 되어 컬럼명이 깨짐
    - 스키마 재정의 및 데이터 복사
- 일부 도메인 값의 통일성 부족
    - `개발자`, `개발자(공인)` 등 동일한 표현 통일
- 합격률에 해당하는 값의 통일성 부족 (소수점, 백분율)
    - `(합격자/응시자)`로 계산 가능 한 필드이므로 재 계산


***

- **external** : 외부 테이블 스키마   
    (csv파일)
    - recruit_table : csv로 저장된 API응답
    - google_trend : csv로 저장된 구글 트렌드 API응답
    - certification : csv로 저장된 자격증 

- **meta** : 외부테이블 값에 대한 메타데이터   
    (API명세 내용)
    - education : 채용 학력코드 상세
    - experiences : 채용 경력코드 상세
    - industries : 채용 산업코드 상세 (소분류)
    - industry_categories : 채용 산업코드 상세 (대분류)
    - job_codes : 채용 키워드
    - location : 채용 지역 상세

- **raw_data** : 외부 데이터에서 정제/전처리 한 데이터   
    (external.recruit_table로부터 레코드별로 id부여 후 정규화)
    - certification : 자격증 취득 현황 테이블
    - experiences : 경력코드-경력값 테이블
    - google_trend : 구글 트렌드 검색량 테이블
    - industries : 산업코드-대분류-소분류 테이블
    - job_doce_keywords : 키워드코드-키워드 테이블
    - locations : 지역코드-전체지역-상세지역
    - recruits : 공고명, 학력, 급여조건, 게시일자, 조회수, 지원수

- **analystic** : 분석용 요약 테이블   
    (특정 태그에 맞는 직종별 id단일 컬럼으로 구성된 조인테이블로써 구성)
    - da_ids : 데이터 분석가 id목록
    - datajob_ids : de, da, ds 세 직종을 합치고 중복 제거한 id목록
    - de_ids : 데이터 엔지니어 id목록
    - ds_ids : 데이터 사이언티스트 id목록
    - embedded_ids : 임베디드 개발자 id목록
    - security_ids : 보안계열 id목록
    - web_back_ids : 웹 백엔드 id목록
    - web_front_ids : 웹 프론트엔드 id목록

- **visual_tables** : 대시보드 연동 테이블
    - all_count : 전체 recruit 데이터레코드 갯수
    - area_ratio : 전체지역 별 채용 비율
    - area_ratio_seoul : 서울 지역 내 채용 비율
    - certifications : 연간 자격증 응시자/합격자/합격률
    - data_job_detail_ratio : 데이터직종 내 상세 비율
    - data_job_ratio : 전체 채용 중 데이터직종 비율
    - dev_industry_datajobs : 개발자 채용 산업 계 (대분류), (it전체, de, da, ds 별)
    - dev_industry_first_detail : 위 대분류에서 최상위 산업분야의 상세 내용 (it전체, de, da, ds 별)
    - google_trends : 주간 구글 트렌드 검색량
    - recruit_for_exp : 위 analystic에서 분류된 직종 별 전체, 경력, 신입무관, 신입 채용 수
    - top_datajob_keywords : 데이터직종 채용 키워드 TOP30 (de, da, ds 별)
    - top_keywords : IT전체 채용 키워드 TOP50

- **adhoc** : 임시 스키마   
    (쓰이진 않으나 참고용으로 가능하기에 남겨둠)
    - area_ratio_gyeonggi : 경기도 지역 채용 수
    - area_ratio_gyeonggi_sum : 경기도 지역 채용 수 ('구'별 구분 없이)
    - count_of_month : 수집된 데이터 월간 분포 (전처리 이후)
    - count_of_year : 수집된 데이터 연간 분포 (전처리 이후)
